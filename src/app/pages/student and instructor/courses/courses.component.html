<app-notification></app-notification>
<div class="courses-layout">
  <aside class="sidebar" role="complementary" aria-label="Sidebar navigation">
    <app-sidebar-wrapper></app-sidebar-wrapper>
  </aside>
  
  <div class="courses-container">
    <!-- Profile component -->
    <div class="profile-header">
      <app-profile 
        [username]="username"
        [role]="getDisplayRole(userRole)"
        [avatarUrl]="avatarUrl"
        (profileUpdate)="onProfileUpdate()"
        (logout)="onLogout()">
      </app-profile>
    </div>
    
    <div class="header">
    <h1 class="title">
      <span *ngIf="sessionService.isInstructor()">KhÃ³a há»c cá»§a tÃ´i</span>
      <span *ngIf="sessionService.isStudent()">KhÃ³a há»c</span>
      <span *ngIf="sessionService.isAdmin()">Tá»•ng quan khÃ³a há»c</span>
      <span *ngIf="!userRole">Danh sÃ¡ch khÃ³a há»c</span>
    </h1>
    <p class="subtitle" *ngIf="userName">
      Xin chÃ o, {{ userName }}
      <span *ngIf="sessionService.isInstructor()">(Giáº£ng viÃªn)</span>
      <span *ngIf="sessionService.isStudent()">(Sinh viÃªn)</span>
      <span *ngIf="sessionService.isAdmin()">(Quáº£n trá»‹ viÃªn)</span>
    </p>
  </div>

  <!-- Loading state -->
  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    <p>Äang táº£i khÃ³a há»c...</p>
  </div>

  <!-- Layout for Students: Two sections -->
  <div *ngIf="!loading && sessionService.isStudent()" class="student-courses-layout">
    
    <!-- Section 1: My Courses (Enrolled) -->
    <div class="section">
      <div class="section-header">
        <h2 class="section-title">ğŸ“š KhÃ³a há»c cá»§a tÃ´i</h2>
        <span class="course-count">({{ enrolledCourses.length }} khÃ³a há»c)</span>
      </div>
      
      <div *ngIf="enrolledCourses.length === 0" class="empty-state">
        <div class="empty-icon">ğŸ“</div>
        <h3>Báº¡n chÆ°a Ä‘Äƒng kÃ½ khÃ³a há»c nÃ o</h3>
        <p>HÃ£y Ä‘Äƒng kÃ½ má»™t khÃ³a há»c tá»« danh sÃ¡ch bÃªn dÆ°á»›i Ä‘á»ƒ báº¯t Ä‘áº§u há»c!</p>
      </div>

      <div *ngIf="enrolledCourses.length > 0" class="courses-grid">
        <div *ngFor="let course of enrolledCourses" 
             class="course-card enrolled clickable" 
             (click)="enterCourse(course)"
             [style.cursor]="'pointer'"
             [title]="'Báº¥m Ä‘á»ƒ vÃ o há»c khÃ³a há»c: ' + getCourseTitle(course)">
          <div class="course-header">
            <div class="course-thumbnail" *ngIf="course.thumbnailUrl">
              <img [src]="'http://localhost:8080/images/courses/' + course.thumbnailUrl" 
                   [alt]="getCourseTitle(course)"
                   class="thumbnail-image">
            </div>
            <div class="course-thumbnail placeholder" *ngIf="!course.thumbnailUrl">
              <div class="placeholder-icon">ğŸ“š</div>
            </div>
            
            <div class="course-header-content">
              <h3 class="course-title">{{ getCourseTitle(course) }}</h3>
              <span class="enrollment-status enrolled">âœ… ÄÃ£ Ä‘Äƒng kÃ½</span>
            </div>
          </div>

          <div class="course-info">
            <p class="course-description">{{ getCourseDescription(course) }}</p>
            <div class="course-meta">
              <div class="meta-item" *ngIf="course.enrolledAt">
                <span class="meta-label">NgÃ y Ä‘Äƒng kÃ½:</span>
                <span class="meta-value">{{ formatDate(course.enrolledAt) }}</span>
              </div>
              <div class="meta-item" *ngIf="course.categoryName">
                <span class="meta-label">Danh má»¥c:</span>
                <span class="meta-value">{{ course.categoryName }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Section 2: Available Courses (Not Enrolled) -->
    <div class="section">
      <div class="section-header">
        <h2 class="section-title">ğŸŒŸ KhÃ³a há»c cÃ³ sáºµn</h2>
        <span class="course-count">({{ availableCourses.length }} khÃ³a há»c)</span>
      </div>

      <div *ngIf="availableCourses.length === 0" class="empty-state">
        <div class="empty-icon">ğŸ“–</div>
        <h3>KhÃ´ng cÃ³ khÃ³a há»c nÃ o khÃ¡c</h3>
        <p>Hiá»‡n táº¡i khÃ´ng cÃ³ khÃ³a há»c nÃ o khÃ¡c Ä‘á»ƒ Ä‘Äƒng kÃ½!</p>
      </div>

      <div *ngIf="availableCourses.length > 0" class="courses-grid">
        <div *ngFor="let course of availableCourses" 
             class="course-card not-enrolled clickable" 
             (click)="enterCourse(course)"
             [style.cursor]="'pointer'"
             [title]="'Báº¥m Ä‘á»ƒ Ä‘Äƒng kÃ½ khÃ³a há»c: ' + getCourseTitle(course)">
          <div class="course-header">
            <div class="course-thumbnail" *ngIf="course.thumbnailUrl">
              <img [src]="'http://localhost:8080/images/courses/' + course.thumbnailUrl" 
                   [alt]="getCourseTitle(course)"
                   class="thumbnail-image">
            </div>
            <div class="course-thumbnail placeholder" *ngIf="!course.thumbnailUrl">
              <div class="placeholder-icon">ğŸ“š</div>
            </div>
            
            <div class="course-header-content">
              <h3 class="course-title">{{ getCourseTitle(course) }}</h3>
              <span class="enrollment-status not-enrolled">ğŸ”“ ChÆ°a Ä‘Äƒng kÃ½</span>
            </div>
          </div>

          <div class="course-info">
            <p class="course-description">{{ getCourseDescription(course) }}</p>
            <div class="course-meta">
              <div class="meta-item" *ngIf="getCoursePrice(course)">
                <span class="meta-label">GiÃ¡:</span>
                <span class="meta-value price">{{ formatPrice(getCoursePrice(course)) }}</span>
              </div>
              <div class="meta-item">
                <span class="meta-label">NgÃ y táº¡o:</span>
                <span class="meta-value">{{ formatDate(getCourseCreatedDate(course)) }}</span>
              </div>
              <div class="meta-item" *ngIf="course.categoryName">
                <span class="meta-label">Danh má»¥c:</span>
                <span class="meta-value">{{ course.categoryName }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Layout for other roles (existing) -->
  <div *ngIf="!loading && !sessionService.isStudent()">
    <!-- Empty state -->
    <div *ngIf="courses.length === 0 && userRole" class="empty-state">
      <div class="empty-icon">ğŸ“š</div>
      <h3 *ngIf="sessionService.isInstructor()">Báº¡n chÆ°a táº¡o khÃ³a há»c nÃ o</h3>
      <h3 *ngIf="sessionService.isAdmin()">KhÃ´ng cÃ³ khÃ³a há»c nÃ o</h3>
      <p *ngIf="sessionService.isInstructor()">HÃ£y táº¡o khÃ³a há»c Ä‘áº§u tiÃªn Ä‘á»ƒ báº¯t Ä‘áº§u giáº£ng dáº¡y!</p>
      <p *ngIf="sessionService.isAdmin()">Há»‡ thá»‘ng chÆ°a cÃ³ khÃ³a há»c nÃ o!</p>
    </div>

    <!-- Courses grid -->
    <div *ngIf="courses.length > 0 && userRole" class="courses-grid">
      <div *ngFor="let course of courses" 
           class="course-card clickable" 
           (click)="enterCourse(course)"
           [style.cursor]="'pointer'"
           [title]="'Báº¥m Ä‘á»ƒ xem khÃ³a há»c: ' + getCourseTitle(course)">
        <div class="course-header">
          <!-- áº¢nh thumbnail khÃ³a há»c -->
          <div class="course-thumbnail" *ngIf="course.thumbnailUrl">
            <img [src]="'http://localhost:8080/images/courses/' + course.thumbnailUrl" 
                 [alt]="getCourseTitle(course)"
                 class="thumbnail-image">
          </div>
          <div class="course-thumbnail placeholder" *ngIf="!course.thumbnailUrl">
            <div class="placeholder-icon">ğŸ“š</div>
          </div>
          
          <div class="course-header-content">
            <h3 class="course-title">{{ getCourseTitle(course) }}</h3>
            
            <!-- Tráº¡ng thÃ¡i khÃ³a há»c cho giáº£ng viÃªn -->
            <span *ngIf="sessionService.isInstructor()" 
                  class="course-status" [class]="course.status">
              {{ course.status === 'published' ? 'ÄÃ£ xuáº¥t báº£n' : 'NhÃ¡p' }}
            </span>
          </div>
        </div>

        <div class="course-info">
          <p class="course-description">
            {{ getCourseDescription(course) }}
          </p>

          <div class="course-meta">
            <div class="meta-item" *ngIf="getCoursePrice(course)">
              <span class="meta-label">GiÃ¡:</span>
              <span class="meta-value price">{{ formatPrice(getCoursePrice(course)) }}</span>
            </div>
            
            <div class="meta-item">
              <span class="meta-label">NgÃ y táº¡o:</span>
              <span class="meta-value">{{ formatDate(getCourseCreatedDate(course)) }}</span>
            </div>

            <div class="meta-item" *ngIf="course.categoryName">
              <span class="meta-label">Danh má»¥c:</span>
              <span class="meta-value">{{ course.categoryName }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</div>

<!-- Notification Component -->
<app-notification></app-notification>
